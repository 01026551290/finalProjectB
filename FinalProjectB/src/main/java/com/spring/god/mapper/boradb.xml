<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="boradb">
	<!-- === 검색어 입력시 자동글 완성하기 6 === -->
    <select id="wordNameSearchView" parameterType="String" resultType="String">
		select NAME
		from LONTION
		where lower(NAME) like '%'||lower(#{searchWord})||'%'
    </select>
	<select id="wordAddrSearchView" parameterType="String" resultType="String">
		select ADDRESS
		from LONTION
		where lower(ADDRESS) like '%'||lower(#{searchWord})||'%'
    </select>

	<select id="getlist" resultType="com.spring.god.bora.model.HotelRoomVO">
		select name, address
		     , img, regDay
		     , star, starcnt
		    from
		    (
		        select rownum AS rno, largecategoryontioncode, name, address, ontionType, img, regDay, hotelidx, star, starcnt
		        from
		        (
		            select name, largecategoryontioncode, address, ontionType, img
		                 , to_char(regDay, 'yyyy-mm-dd') as regDay
		            from lontion
		        ) V LEFT JOIN ( select hotelidx,avg(star) AS STAR,count(*) AS starcnt
		                            from review
		                            group by hotelidx
		                       ) R 
		        on V.largecategoryontioncode = R.hotelidx
		    ) T
		where rno between 1 and 10
	</select>



</mapper>